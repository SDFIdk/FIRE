

<!DOCTYPE html>
<html class="writer-html5" lang="dk" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fire.cli.niv package &mdash; FIRE 1.10.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3a14647b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            FIRE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../konfiguration.html">Konfigurationsfil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installationsvejledning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datamodel.html">FIREs Datamodel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_udviklere.html">Udviklingsguide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Kommandolinjeprogrammer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips/index.html">Tips og tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workshop/index.html">Workshop</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FIRE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">fire.cli.niv package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/fire.cli.niv.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fire-cli-niv-package">
<h1>fire.cli.niv package<a class="headerlink" href="#fire-cli-niv-package" title="Link to this heading"></a></h1>
<section id="module-fire.cli.niv">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fire.cli.niv" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.afbryd_hvis_ugyldigt_jessenpunkt">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">afbryd_hvis_ugyldigt_jessenpunkt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jessenpunkt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.Punkt" title="fire.api.model.punkttyper.Punkt"><span class="pre">Punkt</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fire.cli.niv.afbryd_hvis_ugyldigt_jessenpunkt" title="Link to this definition"></a></dt>
<dd><p>Smid fejl hvis valgt jessenpunkt ikke er et registreret jessenpunkt</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.anvendte">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">anvendte</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arkdef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fire.cli.niv.anvendte" title="Link to this definition"></a></dt>
<dd><p>Anvendte søjler for given arkdef</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.bekraeft">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">bekræft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spørgsmål</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gentag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fire.cli.niv.bekraeft" title="Link to this definition"></a></dt>
<dd><p>Anmod bruger om at tage stilling til spørgsmålet.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.er_projekt_okay">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">er_projekt_okay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#fire.cli.niv.er_projekt_okay" title="Link to this definition"></a></dt>
<dd><p>Kontroller om det er okay at bruge et givet projekt.</p>
<p>Afbryder programmet og udskriver en fejl, hvis ikke projektet er okay.</p>
<p>Ellers gøres intet.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.find_faneblad">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">find_faneblad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faneblad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arkdef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_failure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#fire.cli.niv.find_faneblad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.find_parameter">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">find_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fire.cli.niv.find_parameter" title="Link to this definition"></a></dt>
<dd><p>Find parameter fra et projektregneark</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.find_sag">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">find_sag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepter_inaktiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="fire.api.model.html#fire.api.model.sagstyper.Sag" title="fire.api.model.sagstyper.Sag"><span class="pre">Sag</span></a></span></span><a class="headerlink" href="#fire.cli.niv.find_sag" title="Link to this definition"></a></dt>
<dd><p>Bomb hvis sag for projektnavn ikke er oprettet. Ellers returnér sagen</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.find_sagsgang">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">find_sagsgang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#fire.cli.niv.find_sagsgang" title="Link to this definition"></a></dt>
<dd><p>Udtræk sagsgangsregneark fra Excelmappe</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.find_sagsid">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">find_sagsid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sagsgang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#fire.cli.niv.find_sagsid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.gyldighedstidspunkt">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">gyldighedstidspunkt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span></span></span><a class="headerlink" href="#fire.cli.niv.gyldighedstidspunkt" title="Link to this definition"></a></dt>
<dd><p>Tid for sidste observation der har været brugt i beregningen</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.hent_relevante_tidsserier">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">hent_relevante_tidsserier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hts_ark</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">punkt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.Punkt" title="fire.api.model.punkttyper.Punkt"><span class="pre">Punkt</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fastholdt_punkt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.Punkt" title="fire.api.model.punkttyper.Punkt"><span class="pre">Punkt</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fastholdt_kote</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tidsserie</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fire.cli.niv.hent_relevante_tidsserier" title="Link to this definition"></a></dt>
<dd><p>Henter de relevante tidsserier fra Højdetidsserier-arket</p>
<p>Med &quot;relevante&quot; skal forstås tidsserier der har <code class="docutils literal notranslate"><span class="pre">punkt</span></code> som punkt, og som hører
under en punktsamling der har <code class="docutils literal notranslate"><span class="pre">fastholdt_punkt</span></code> og <code class="docutils literal notranslate"><span class="pre">fastholdt_kote</span></code> som fastholdt
punkt hhv. kote.</p>
<p>Derudover kontrolleres oplysningerne i Højdetidsserier-fanen. Hvis de er forkerte
udsendes fejlmeddelelser.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.opret_region_punktinfo">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">opret_region_punktinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">punkt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.Punkt" title="fire.api.model.punkttyper.Punkt"><span class="pre">Punkt</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.PunktInformation" title="fire.api.model.punkttyper.PunktInformation"><span class="pre">PunktInformation</span></a></span></span><a class="headerlink" href="#fire.cli.niv.opret_region_punktinfo" title="Link to this definition"></a></dt>
<dd><p>Opret regionspunktinfo for et nyt punkt</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.skriv_ark">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">skriv_ark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projektnavn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nye_faneblade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#fire.cli.niv.skriv_ark" title="Link to this definition"></a></dt>
<dd><p>Skriv resultater til excel-fil</p>
<p>Basalt en temmeligt simpel operation, men virkemåden er næsten overskygget af
kontroller af at filoperationer gik godt. Det er et vilkår ved interaktioner
med filsystemer, så for overblikkets skyld kommer her en kort prosabeskrivelse.</p>
<ol class="arabic simple">
<li><p>Flyt projektnavn.xlsx til projektnavn-ex.xlsx</p></li>
<li><p>Læs dict gamle_faneblade fra projektnavn-ex.xlsx</p></li>
<li><p>Fjern elementer fra gamle_faneblade hvis navnet også findes i nye_faneblade</p></li>
<li><p>Skriv nye_faneblade til projektnavn.xlsx</p></li>
<li><p>Skriv gamle_faneblade til projektnavn.xlsx</p></li>
</ol>
<p>Trin 4 kommer før trin 5 for at sikre at de nye faneblade er umiddelbart
synlige når man åbner projektnavn.xlsx</p>
<p>Eller mere direkte sagt:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
fil = Path(f&quot;{projektnavn}{suffix}.xlsx&quot;)
exfil = Path(f&quot;{projektnavn}{suffix}-ex.xlsx&quot;)
fil.replace(exfil)</p>
<p>gamle_faneblade = pd.read_excel(exfil, sheet_name=None)
for fanebladnavn in set(gamle_faneblade).intersection(nye_faneblade):</p>
<blockquote>
<div><p>gamle_faneblade.pop(fanebladnavn)</p>
</div></blockquote>
<dl class="simple">
<dt>with pd.ExcelWriter(fil) as writer:</dt><dd><p>skriv nye_faneblade
skriv gamle_faneblade</p>
</dd>
</dl>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
<p>Hvilket er i omegnen af en faktor 10 mindre end den implementerede
version - men <em>it's a jungle out there</em>...</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fire.cli.niv.udled_jessenpunkt_fra_punktoversigt">
<span class="sig-prename descclassname"><span class="pre">fire.cli.niv.</span></span><span class="sig-name descname"><span class="pre">udled_jessenpunkt_fra_punktoversigt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">punktoversigt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="fire.api.model.html#fire.api.model.punkttyper.Punkt" title="fire.api.model.punkttyper.Punkt"><span class="pre">Punkt</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#fire.cli.niv.udled_jessenpunkt_fra_punktoversigt" title="Link to this definition"></a></dt>
<dd><p>Udleder Jessenpunktet ud fra oplysningerne i Punktoversigten.</p>
<p>Returnerer oplysninger om det validerede jessenpunkt.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2026 SDFI, Septima.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>